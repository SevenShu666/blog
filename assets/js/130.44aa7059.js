(window.webpackJsonp=window.webpackJsonp||[]).push([[130],{407:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"electron"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#electron"}},[t._v("#")]),t._v(" Electron")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("electron文档"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cn-evite.netlify.app/guide/",target:"_blank",rel:"noopener noreferrer"}},[t._v("electron-vite文档"),s("OutboundLink")],1)]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.electron.build/auto-update",target:"_blank",rel:"noopener noreferrer"}},[t._v("electron-build文档"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"一、主进程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、主进程"}},[t._v("#")]),t._v(" 一、主进程")]),t._v(" "),s("p",[t._v("一个"),s("code",[t._v("electron")]),t._v("有且只有一个主进程（main文件夹下）")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// main.js")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Modules to control application life and create native browser window")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" BrowserWindow "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" path "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'node:path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("createWindow")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Create the browser window.")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" mainWindow "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrowserWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("width")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("800")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("height")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("600")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("webPreferences")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("preload")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'preload.js'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 加载 index.html")]),t._v("\n  mainWindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadFile")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'index.html'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 打开开发工具")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mainWindow.webContents.openDevTools()")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这段程序将会在 Electron 结束初始化")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 和创建浏览器窗口的时候调用")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 部分 API 在 ready 事件触发后才能使用。")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("whenReady")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'activate'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在 macOS 系统内, 如果没有已开启的应用窗口")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 点击托盘图标时通常会重新创建一个新窗口")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BrowserWindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getAllWindows")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 除了 macOS 外，当所有窗口都被关闭的时候退出程序。 因此, 通常")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对应用程序和它们的菜单栏来说应该时刻保持激活状态, ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 直到用户使用 Cmd + Q 明确退出")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'window-all-closed'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("platform "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'darwin'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("quit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在当前文件中你可以引入所有的主进程代码")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 也可以拆分成几个文件，然后用 require 导入。")]),t._v("\n")])])]),s("h2",{attrs:{id:"二、主进程和渲染进程通讯"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、主进程和渲染进程通讯"}},[t._v("#")]),t._v(" 二、主进程和渲染进程通讯")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("contextBridge")]),t._v("在隔离的上下文中创建一个安全的、双向的、同步的桥梁。")]),t._v(" "),s("p",[t._v("通过预加载脚本将api暴露给渲染进程")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Preload (Isolated World)")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" contextBridge"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ipcRenderer "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\ncontextBridge"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exposeInMainWorld")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("doThing")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" ipcRenderer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'do-a-thing'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ul",[s("li",[t._v("ipcRenderer：在预加载脚本暴露给渲染进程的api，发送消息给到主进程")]),t._v(" "),s("li",[t._v("ipcMain：在主进程中接收渲染进程的消息")])]),t._v(" "),s("h2",{attrs:{id:"三、app"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、app"}},[t._v("#")]),t._v(" 三、app")]),t._v(" "),s("p",[t._v("控制应用程序的事件生命周期。")]),t._v(" "),s("p",[t._v("事件：")]),t._v(" "),s("ol",[s("li",[t._v("ready：当 Electron 完成初始化时，发出一次。")]),t._v(" "),s("li",[t._v("window-all-closed：当所有的窗口都被关闭时触发。")]),t._v(" "),s("li",[t._v("before-quit：在程序关闭窗口前发信号。")]),t._v(" "),s("li",[t._v("will-quit：当所有窗口被关闭后触发，同时应用程序将退出。 调用 "),s("code",[t._v("event.preventDefault()")]),t._v(" 将阻止终止应用程序的默认行为。")]),t._v(" "),s("li",[t._v("quit：在应用程序退出时发出。")])]),t._v(" "),s("p",[t._v("方法：")]),t._v(" "),s("ol",[s("li",[t._v("app.quit()：尝试关闭所有窗口 将首先发出 "),s("code",[t._v("before-quit")]),t._v(" 事件。 如果所有窗口都已成功关闭, 则将发出 "),s("code",[t._v("will-quit")]),t._v(" 事件, 并且默认情况下应用程序将终止。")]),t._v(" "),s("li",[t._v("app.hide()：隐藏所有的应用窗口，不是最小化。")]),t._v(" "),s("li",[t._v("app.show()：显示隐藏后的应用程序窗口。 不会使它们自动获得焦点。")])]),t._v(" "),s("h2",{attrs:{id:"四、browserwindow"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、browserwindow"}},[t._v("#")]),t._v(" 四、BrowserWindow")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("new BrowserWindow([options])")]),t._v("：创建并控制浏览器窗口\n"),s("ol",[s("li",[s("code",[t._v("width")]),t._v(" 整数型 (可选) - 窗口的宽度（以像素为单位）。 默认值为 "),s("code",[t._v("800")]),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("height")]),t._v(" 整数型 (可选) - 窗口的高度（以像素为单位）。 默认值为 "),s("code",[t._v("600")]),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("x")]),t._v(" Interger (可选) - ("),s("strong",[t._v("必选")]),t._v(" 如果使用了y) 窗口相对于屏幕左侧的偏移量。 默认值为将窗口居中。")]),t._v(" "),s("li",[s("code",[t._v("y")]),t._v(" Integer (可选) - ("),s("strong",[t._v("必选")]),t._v(" 如果使用了x) 窗口相对于屏幕顶端的偏移量。 默认值为将窗口居中。")]),t._v(" "),s("li",[s("code",[t._v("center")]),t._v(" boolean (可选) - 窗口是否在屏幕居中. 默认值为 "),s("code",[t._v("false")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("frame")]),t._v(" boolean (可选) - 设置为 "),s("code",[t._v("false")]),t._v(" 时可以创建一个"),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/tutorial/window-customization#create-frameless-windows",target:"_blank",rel:"noopener noreferrer"}},[t._v("无边框窗口"),s("OutboundLink")],1),t._v(" 默认值为 "),s("code",[t._v("true")]),t._v("。")])])])]),t._v(" "),s("p",[t._v("事件：")]),t._v(" "),s("ol",[s("li",[t._v("close：在窗口要关闭的时候触发。 它在DOM 的"),s("code",[t._v("beforeunload")]),t._v(" 和 "),s("code",[t._v("unload")]),t._v(" 事件之前触发. 调用"),s("code",[t._v("event.preventDefault()")]),t._v("将阻止这个操作。")]),t._v(" "),s("li",[t._v("blur：当窗口失去焦点时触发")]),t._v(" "),s("li",[t._v("focus：当窗口获得焦点时触发")]),t._v(" "),s("li",[t._v("show：当窗口显示时触发")]),t._v(" "),s("li",[t._v("hide：当窗口隐藏时触发")]),t._v(" "),s("li",[t._v("ready-to-show：当页面已经渲染完成(但是还没有显示) 并且窗口可以被显示时触发")]),t._v(" "),s("li",[t._v("restore：当窗口从最小化状态恢复时触发")]),t._v(" "),s("li",[t._v("resize：调整窗口大小后触发")]),t._v(" "),s("li",[t._v("move：窗口移动到新位置时触发")])]),t._v(" "),s("p",[t._v("静态方法：")]),t._v(" "),s("ol",[s("li",[t._v("BrowserWindow.getAllWindows()：所有打开的窗口的数组")]),t._v(" "),s("li",[t._v("BrowserWindow.getFocusedWindow()：此应用程序中当前获得焦点的窗口，如果无就返回 "),s("code",[t._v("null")])]),t._v(" "),s("li",[t._v("BrowserWindow.fromWebContents(webContents)：返回拥有给定 "),s("code",[t._v("webContents")]),t._v("的窗口，否则如果内容不属于一个窗口，返回"),s("code",[t._v("null")]),t._v("。\n"),s("ul",[s("li",[t._v("event.sender 返回发送消息的 webContents")])])]),t._v(" "),s("li",[t._v("BrowserWindow.fromBrowserView(browserView)：拥有给定 "),s("code",[t._v("browserView")]),t._v(" 的窗口。 如果给定的视图没有附加到任何窗口，返回 "),s("code",[t._v("null")]),t._v("。")]),t._v(" "),s("li",[t._v("BrowserWindow.fromId(id)：带有给定 "),s("code",[t._v("id")]),t._v(" 的窗口。")])]),t._v(" "),s("p",[t._v("实例属性：")]),t._v(" "),s("ol",[s("li",[t._v("win.webContents：此窗口拥有的 "),s("code",[t._v("WebContents")]),t._v(" 对象。 所有与网页相关的事件和操作都将通过它完成。")]),t._v(" "),s("li",[t._v("win.id：一个 "),s("code",[t._v("Integer")]),t._v(" 属性代表了窗口的唯一ID。 每个ID在整个Electron应用程序的所有 "),s("code",[t._v("BrowserWindow")]),t._v(" 实例中都是唯一的。")])]),t._v(" "),s("p",[t._v("实例方法：")]),t._v(" "),s("ol",[s("li",[t._v("win.destroy()：强制关闭窗口, 除了"),s("code",[t._v("closed")]),t._v("之外，"),s("code",[t._v("close")]),t._v("，"),s("code",[t._v("unload")]),t._v(" 和 "),s("code",[t._v("beforeunload")]),t._v(" 都不会被触发")]),t._v(" "),s("li",[t._v("win.close()：尝试关闭窗口。 该方法与用户手动单击窗口的关闭按钮效果相同。 但网页可能会取消这个关闭操作。")]),t._v(" "),s("li",[t._v("win.focus()：聚焦于窗口")]),t._v(" "),s("li",[t._v("win.blur()：取消窗口的聚焦")]),t._v(" "),s("li",[t._v("win.show()：显示并聚焦于窗口")]),t._v(" "),s("li",[t._v("win.hide()：隐藏窗口")]),t._v(" "),s("li",[t._v("win.maximize()：最大化窗口")]),t._v(" "),s("li",[t._v("win.minimize()：最小化窗口")])]),t._v(" "),s("h2",{attrs:{id:"五、dialog"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、dialog"}},[t._v("#")]),t._v(" 五、dialog")]),t._v(" "),s("p",[t._v("显示用于打开和保存文件、警报等的本机系统对话框。")]),t._v(" "),s("h3",{attrs:{id:"dialog-showsavedialog-browserwindow-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dialog-showsavedialog-browserwindow-options"}},[t._v("#")]),t._v(" "),s("code",[t._v("dialog.showSaveDialog([browserWindow, ]options)")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("browserWindow")]),t._v(" "),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/browser-window",target:"_blank",rel:"noopener noreferrer"}},[t._v("BrowserWindow"),s("OutboundLink")],1),t._v(" (可选)")]),t._v(" "),s("li",[t._v("选项对象\n"),s("ul",[s("li",[s("code",[t._v("title")]),t._v(" string (可选) - 对话框标题。 无法在一些 "),s("em",[t._v("Linux")]),t._v(" 桌面环境中显示。")]),t._v(" "),s("li",[s("code",[t._v("defaultPath")]),t._v(" string (可选) - 默认情况下使用的绝对目录路径、绝对文件路径或文件名。")]),t._v(" "),s("li",[s("code",[t._v("buttonLabel")]),t._v(" string (可选) - 「确认」按钮的自定义标签, 当为空时, 将使用默认标签。")]),t._v(" "),s("li",[s("code",[t._v("filters")]),t._v(" "),s("a",{attrs:{href:"%E5%8F%AF%E9%80%89"}},[t._v("FileFilter[]")])]),t._v(" "),s("li",[s("code",[t._v("message")]),t._v(" string (可选) "),s("em",[t._v("macOS")]),t._v(" -显示在对话框上的消息。")]),t._v(" "),s("li",[s("code",[t._v("nameFieldLabel")]),t._v(" string (可选) "),s("em",[t._v("macOS")]),t._v(" - 文件名输入框对应的自定义标签名。")]),t._v(" "),s("li",[s("code",[t._v("showsTagField")]),t._v(" boolean (可选) "),s("em",[t._v("macOS")]),t._v(" - 显示标签输入框，默认为 "),s("code",[t._v("true")]),t._v("。")]),t._v(" "),s("li",[t._v("properties string[](可选)\n"),s("ul",[s("li",[s("code",[t._v("showHiddenFiles")]),t._v("-显示对话框中的隐藏文件。")]),t._v(" "),s("li",[s("code",[t._v("createDirectory")]),t._v(" "),s("em",[t._v("macOS")]),t._v(" -允许你通过对话框的形式创建新的目录。")]),t._v(" "),s("li",[s("code",[t._v("treatPackageAsDirectory")]),t._v(" "),s("em",[t._v("macOS")]),t._v(" -将包 (如 "),s("code",[t._v(".app")]),t._v("文件夹) 视为目录而不是文件。")]),t._v(" "),s("li",[s("code",[t._v("showOverwriteConfirmation")]),t._v(" "),s("em",[t._v("Linux")]),t._v(" - 设置如果用户输入了已存在的文件名，是否会向用户显示确认对话框。")]),t._v(" "),s("li",[s("code",[t._v("dontAddToRecent")]),t._v(" "),s("em",[t._v("Windows")]),t._v(" - 不要将正在保存的项目添加到最近的文档列表中。")])])]),t._v(" "),s("li",[s("code",[t._v("securityScopedBookmarks")]),t._v(" boolean (可选) "),s("em",[t._v("macOS")]),t._v(" "),s("em",[t._v("MAS")]),t._v(" - 在打包提交到Mac App Store时创建 "),s("a",{attrs:{href:"https://developer.apple.com/library/content/documentation/Security/Conceptual/AppSandboxDesignGuide/AppSandboxInDepth/AppSandboxInDepth.html#//apple_ref/doc/uid/TP40011183-CH3-SW16",target:"_blank",rel:"noopener noreferrer"}},[t._v("security scoped bookmarks"),s("OutboundLink")],1),t._v(" 当该选项被启用且文件尚不存在时，那么在选定的路径下将创建一个空文件。")])])])]),t._v(" "),s("p",[t._v("返回 "),s("code",[t._v("Promise<Object>")]),t._v(" - resolve包含以下内容的object：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("canceled")]),t._v(" boolean - 对话框是否被取消。")]),t._v(" "),s("li",[s("code",[t._v("filePath")]),t._v(" string (可选) - 如果对话框被取消，该值为 "),s("code",[t._v("undefined")]),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("bookmark")]),t._v(" string(optional) "),s("em",[t._v("macOS")]),t._v(" "),s("em",[t._v("MAS")]),t._v(" - 包含了安全作用域的书签数据 Base64 编码的字符串来保存文件。 "),s("code",[t._v("securityScopedBookmarks")]),t._v(" 必须启用才有效。 (返回值见 "),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/dialog#bookmarks-array",target:"_blank",rel:"noopener noreferrer"}},[t._v("这里的表格"),s("OutboundLink")],1),t._v("。)")])]),t._v(" "),s("p",[s("strong",[t._v("注意：")]),t._v(" 在macOS上，建议使用异步版本，以避免展开和折叠对话框时出现问题。")]),t._v(" "),s("h3",{attrs:{id:"dialog-showmessagebox-browserwindow-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dialog-showmessagebox-browserwindow-options"}},[t._v("#")]),t._v(" "),s("code",[t._v("dialog.showMessageBox([browserWindow, ]options)")])]),t._v(" "),s("p",[t._v("显示一个消息框")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("browserWindow")]),t._v(" "),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/browser-window",target:"_blank",rel:"noopener noreferrer"}},[t._v("BrowserWindow"),s("OutboundLink")],1),t._v(" (可选)")]),t._v(" "),s("li",[t._v("选项对象\n"),s("ul",[s("li",[s("code",[t._v("message")]),t._v(" string - message box 的内容.")]),t._v(" "),s("li",[s("code",[t._v("type")]),t._v(" string (可选) - 可以为 "),s("code",[t._v("none")]),t._v(", "),s("code",[t._v("info")]),t._v(", "),s("code",[t._v("error")]),t._v(", "),s("code",[t._v("question")]),t._v(" 或者 "),s("code",[t._v("warning")]),t._v(". 在 Windows 上, "),s("code",[t._v("question")]),t._v(" 与"),s("code",[t._v("info")]),t._v("显示相同的图标, 除非你使用了 "),s("code",[t._v("icon")]),t._v(" 选项设置图标。 在 macOS 上, "),s("code",[t._v("warning")]),t._v(" 和 "),s("code",[t._v("error")]),t._v(" 显示相同的警告图标")]),t._v(" "),s("li",[s("code",[t._v("buttons")]),t._v(" string[] (可选) - 按钮文本数组。 在 Windows上，一个空数组将导致按钮被标为“OK”。")]),t._v(" "),s("li",[s("code",[t._v("defaultId")]),t._v(" Integer (可选) - 在 message box 对话框打开的时候，设置默认选中的按钮，值为在 buttons 数组中的索引.")]),t._v(" "),s("li",[s("code",[t._v("signal")]),t._v(" AbortSignal (可选) - 通过 "),s("a",{attrs:{href:"https://nodejs.org/api/globals.html#globals_class_abortsignal",target:"_blank",rel:"noopener noreferrer"}},[t._v("AbortSignal"),s("OutboundLink")],1),t._v(" 信号实例可选地关闭消息框，消息框的行为就像用户点击取消一样。 在 macOS, "),s("code",[t._v("signal")]),t._v(" 不适用于没有父窗口的消息框。因为平台限制，这些消息框同步运行")]),t._v(" "),s("li",[s("code",[t._v("title")]),t._v(" string (可选) - message box 的标题，一些平台不显示.")]),t._v(" "),s("li",[s("code",[t._v("detail")]),t._v(" string (可选) - 额外信息.")]),t._v(" "),s("li",[s("code",[t._v("checkboxLabel")]),t._v(" string (可选) - 如果使用了，消息框将包含带有给定标签的复选框。")]),t._v(" "),s("li",[s("code",[t._v("checkboxChecked")]),t._v(" boolean (可选) - checkbox 的初始值。 默认值为 "),s("code",[t._v("false")])]),t._v(" "),s("li",[s("code",[t._v("icon")]),t._v(" ("),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/native-image",target:"_blank",rel:"noopener noreferrer"}},[t._v("NativeImage"),s("OutboundLink")],1),t._v(" | string) (可选)")]),t._v(" "),s("li",[s("code",[t._v("textWidth")]),t._v(" Integer (可选) "),s("em",[t._v("macOS")]),t._v(" - 自定义消息框中文本的宽度")]),t._v(" "),s("li",[s("code",[t._v("cancelId")]),t._v(" Integer (可选) - 用于取消对话框的按钮的索引，例如 "),s("code",[t._v("Esc")]),t._v(" 键. 默认情况下，它被分配给第一个按钮，文字为 “cancel” 或 “no”。 如果不存在这个标签的按钮，同时该选项又未设置，返回值为"),s("code",[t._v("0")]),t._v("。")]),t._v(" "),s("li",[s("code",[t._v("noLink")]),t._v(" boolean (可选) - 在Windows上，应用将尝试找出哪个 "),s("code",[t._v("buttons")]),t._v(' 是常用按钮(例如 "Cancel" 或 "Yes")，然后在对话框中以链接命令的方式展现其它的按钮。 这可以使对话框以现代Windows应用程序的风格显示。 如果你不喜欢这个行为, 你可以设置 '),s("code",[t._v("noLink")]),t._v(" 为 "),s("code",[t._v("true")]),t._v(".")]),t._v(" "),s("li",[s("code",[t._v("normalizeAccessKeys")]),t._v(" boolean (可选) -规范跨平台的键盘访问键。 默认值为 "),s("code",[t._v("false")]),t._v(". 用 "),s("code",[t._v("&")]),t._v(" 连接和转换键盘访问键, 以便它们在每个平台上正常工作."),s("code",[t._v("&")]),t._v(" 字符会在macOS上被删除，在 Linux 上会被转换为 "),s("code",[t._v("_")]),t._v("，在 Windows 上保持不变。 例如 "),s("code",[t._v("Vie&w")]),t._v(" 的按钮标签在 Linux 上会被转换为 "),s("code",[t._v("Vie_w")]),t._v("，在 macOS 转换为 "),s("code",[t._v("View")]),t._v(" 并且可以被选择。而Windows和Linux上表示 "),s("code",[t._v("Alt-W")]),t._v(" 。")])])])]),t._v(" "),s("p",[t._v("返回 "),s("code",[t._v("Promise<Object>")]),t._v(" - resolve包含以下属性的promise：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("response")]),t._v(" number - 点击的按钮的索引。")]),t._v(" "),s("li",[s("code",[t._v("checkboxChecked")]),t._v(" boolean - 如果设置了 "),s("code",[t._v("checkboxLabel")]),t._v("，返回复选框是否被选中的状态。 否则，返回 "),s("code",[t._v("false")]),t._v("。")])]),t._v(" "),s("h2",{attrs:{id:"六、globalshortcut"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、globalshortcut"}},[t._v("#")]),t._v(" 六、globalShortcut")]),t._v(" "),s("p",[t._v("在应用程序没有键盘焦点时，监听键盘事件，自定义快捷键。")]),t._v(" "),s("h3",{attrs:{id:"globalshortcut-register-accelerator-callback"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#globalshortcut-register-accelerator-callback"}},[t._v("#")]),t._v(" "),s("code",[t._v("globalShortcut.register(accelerator, callback)")])]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("accelerator")]),t._v(" "),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/accelerator",target:"_blank",rel:"noopener noreferrer"}},[t._v("Accelerator"),s("OutboundLink")],1)])]),t._v(" "),s("li",[s("p",[s("code",[t._v("callback")]),t._v(" Function")])])]),t._v(" "),s("p",[t._v("返回"),s("code",[t._v("boolean")]),t._v(" - 快捷键注册是否成功")]),t._v(" "),s("p",[t._v("注册 "),s("code",[t._v("accelerator")]),t._v(" 的全局快捷键。 当用户按下注册快捷键时， "),s("code",[t._v("callback")]),t._v(" 会被调用。")]),t._v(" "),s("p",[t._v("如果指定的快捷键已经被其他应用程序注册掉, 调用会默默失败。 该特性由操作系统定义，因为操作系统不希望多个程序的全局快捷键互相冲突。")]),t._v(" "),s("p",[t._v("在 macOS 10.14 Mojave 下面，如果 app 没有被授权为"),s("a",{attrs:{href:"https://developer.apple.com/library/archive/documentation/Accessibility/Conceptual/AccessibilityMacOSX/OSXAXTestingApps.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("可信任使用的客户端"),s("OutboundLink")],1),t._v("，那么下列快捷键会注册失败：")]),t._v(" "),s("ul",[s("li",[t._v('"Media Play/Pause"')]),t._v(" "),s("li",[t._v('"Media Next Track"')]),t._v(" "),s("li",[t._v('"Media Previous Track"')]),t._v(" "),s("li",[t._v('"Media Stop"')])]),t._v(" "),s("h2",{attrs:{id:"七、menu"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、menu"}},[t._v("#")]),t._v(" 七、Menu")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("Menu.buildFromTemplate(template)：定义菜单，"),s("code",[t._v("template")]),t._v("是一个"),s("code",[t._v("options")]),t._v("类型的数组")]),t._v(" "),s("ul",[s("li",[s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromTemplate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("label")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'退出应用'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("click")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("quit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("Menu.getApplicationMenu()：设置菜单")])])]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" win "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BrowserWindow")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("width")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("800")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("height")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1500")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webContents\n\nwc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"context-menu"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("e")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 右键触发自定义菜单")]),t._v("\n\tcontextMenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("popup")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"八、tray"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#八、tray"}},[t._v("#")]),t._v(" 八、Tray")]),t._v(" "),s("p",[t._v("添加图标和上下文菜单到系统通知区")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Tray"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" BrowserWindow "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" resolve "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'path'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" createTray "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" BrowserWindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" tray "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Tray")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__dirname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../resources/camera.png'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" contextMenu "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Menu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("buildFromTemplate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("label")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'退出应用'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("click")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("quit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  tray"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'click'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("isMinimized")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),t._v(" win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("restore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("minimize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  tray"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setToolTip")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'落日摄像头'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  tray"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("setContextMenu")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("contextMenu"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" createTray"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h2",{attrs:{id:"九、clipboard"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#九、clipboard"}},[t._v("#")]),t._v(" 九、clipboard")]),t._v(" "),s("p",[t._v("在系统剪贴板上执行复制和粘贴操作。")]),t._v(" "),s("p",[t._v("方法：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("clipboard.readText([type])：读取剪贴板中的内容(纯文本)。")]),t._v(" "),s("ul",[s("li",[s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" clipboard "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nclipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello i am a bit of text!'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// hello i am a bit of text!'")]),t._v("\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("clipboard.writeText(text[, type])：写入剪贴板中的内容(纯文本)。")]),t._v(" "),s("ul",[s("li",[s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" clipboard "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" text "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello i am a bit of text!'")]),t._v("\nclipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeText")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("text"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("clipboard.readHTML([type])：读取剪贴板中的内容(Html代码)。")]),t._v(" "),s("ul",[s("li",[s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" clipboard "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nclipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHTML")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<b>Hi</b>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" html "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" clipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("readHTML")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// <meta charset='utf-8'><b>Hi</b>")]),t._v("\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("clipboard.writeHTML(markup[, type])：写入剪贴板中的内容(Html代码)。")]),t._v(" "),s("ul",[s("li",[s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" clipboard "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nclipboard"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("writeHTML")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<b>Hi</b>'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("clipboard.readImage([type])：读取剪贴板中的图像内容。")])]),t._v(" "),s("li",[s("p",[t._v("clipboard.writeImage(image[, type])：写入剪贴板中的图像内容。")])]),t._v(" "),s("li",[s("p",[t._v("clipboard.clear([type])：清除剪贴板内容。")])]),t._v(" "),s("li",[s("p",[t._v("clipboard.has(format[, type])：返回 "),s("code",[t._v("boolean")]),t._v(" - 剪贴板是否存在指定内容")])])]),t._v(" "),s("h2",{attrs:{id:"十、nativeimage"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十、nativeimage"}},[t._v("#")]),t._v(" 十、nativeImage")]),t._v(" "),s("h3",{attrs:{id:"nativeimage-createfrompath-path"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nativeimage-createfrompath-path"}},[t._v("#")]),t._v(" nativeImage.createFromPath(path)")]),t._v(" "),s("p",[t._v("从位于 "),s("code",[t._v("path")]),t._v(" 的文件创建新的 "),s("code",[t._v("NativeImage")]),t._v(" 实例。 如果 "),s("code",[t._v("path")]),t._v(" 不存在，，无法读取或不是有效图像，方法将返回空图像, 。")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("const nativeImage = require('electron').nativeImage\n\nconst image = nativeImage.createFromPath('/Users/somebody/images/icon.png')\nconsole.log(image)\n")])])]),s("h4",{attrs:{id:"image-topng-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#image-topng-options"}},[t._v("#")]),t._v(" "),s("code",[t._v("image.toPNG([options])")])]),t._v(" "),s("ul",[s("li",[t._v("options Object (可选)\n"),s("ul",[s("li",[s("code",[t._v("scaleFactor")]),t._v(" Number (可选) - 默认值为 1.0。")])])])]),t._v(" "),s("p",[t._v("返回 "),s("code",[t._v("Buffer")]),t._v("-一个包含图像 "),s("code",[t._v("PNG")]),t._v(" 编码数据的 "),s("a",{attrs:{href:"https://nodejs.org/api/buffer.html#buffer_class_buffer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Buffer "),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"image-tojpeg-quality"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#image-tojpeg-quality"}},[t._v("#")]),t._v(" "),s("code",[t._v("image.toJPEG(quality)")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("quality")]),t._v(" Integer - 在 0 - 100 之间")])]),t._v(" "),s("p",[t._v("返回 "),s("code",[t._v("Buffer")]),t._v("-一个包含图像 "),s("code",[t._v("JPEG")]),t._v(" 编码数据的 "),s("a",{attrs:{href:"https://nodejs.org/api/buffer.html#buffer_class_buffer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Buffer "),s("OutboundLink")],1),t._v("。")]),t._v(" "),s("h4",{attrs:{id:"image-todataurl-options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#image-todataurl-options"}},[t._v("#")]),t._v(" "),s("code",[t._v("image.toDataURL([options])")])]),t._v(" "),s("ul",[s("li",[t._v("options Object (可选)\n"),s("ul",[s("li",[s("code",[t._v("scaleFactor")]),t._v(" Number (可选) - 默认值为 1.0。")])])])]),t._v(" "),s("p",[t._v("返回 "),s("code",[t._v("string")]),t._v(" - 图像的 data URL。")]),t._v(" "),s("h4",{attrs:{id:"image-getsize-scalefactor"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#image-getsize-scalefactor"}},[t._v("#")]),t._v(" "),s("code",[t._v("image.getSize([scaleFactor])")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("scaleFactor")]),t._v(" Number (可选) - 默认值为 1.0。")])]),t._v(" "),s("p",[t._v("Returns "),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/structures/size",target:"_blank",rel:"noopener noreferrer"}},[t._v("Size"),s("OutboundLink")],1),t._v(".")]),t._v(" "),s("p",[t._v("如果传递了 "),s("code",[t._v("scaleFactor")]),t._v(" ，将返回与图像表示最接近的传递值对应的大小。")]),t._v(" "),s("h4",{attrs:{id:"image-crop-rect"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#image-crop-rect"}},[t._v("#")]),t._v(" "),s("code",[t._v("image.crop(rect)")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("rect")]),s("a",{attrs:{href:"https://www.electronjs.org/zh/docs/latest/api/structures/rectangle",target:"_blank",rel:"noopener noreferrer"}},[t._v("Rectangle"),s("OutboundLink")],1),t._v("-要裁剪的图像区域.")])]),t._v(" "),s("p",[t._v("返回 "),s("code",[t._v("NativeImage")]),t._v("-裁剪的图像。")]),t._v(" "),s("h2",{attrs:{id:"十一、工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#十一、工具"}},[t._v("#")]),t._v(" 十一、工具")]),t._v(" "),s("h3",{attrs:{id:"_1-electron-updater"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-electron-updater"}},[t._v("#")]),t._v(" 1.electron-updater")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" is "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@electron-toolkit/utils'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" BrowserWindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" dialog"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" shell "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" autoUpdater "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron-updater'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 自动下载更新")]),t._v("\nautoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("autoDownload "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 退出时自动安装更新")]),t._v("\nautoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("autoInstallOnAppQuit "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("win"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" BrowserWindow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 检查是否有更新")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("is"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("dev"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("checkForUpdates")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 有新版本")]),t._v("\n  autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update-available'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    dialog\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showMessageBox")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'info'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'更新信息'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发现新版本'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("buttons")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'现在更新'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'下次一定'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cancelId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新")]),t._v("\n          autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("downloadUpdate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 没有新版本")]),t._v("\n  autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update-not-available'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("_info")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" any")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webContents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'version'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" _info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tag"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新完毕")]),t._v("\n  autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'update-downloaded'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 退出并安装更新")]),t._v("\n    autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("quitAndInstall")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 更新出错")]),t._v("\n  autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("_info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    dialog\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("showMessageBox")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'error'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("title")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'更新失败'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'软件更新失败'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("buttons")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'发布页面下载'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'取消更新'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("cancelId")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("res")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("res"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          shell"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("openExternal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://starrysky-future.github.io/blog/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 监听下载进度")]),t._v("\n  autoUpdater"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("on")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'download-progress'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("progress")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    win"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("webContents"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'downloadProgress'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" progress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h3",{attrs:{id:"_2-electron-toolkit-preload"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-electron-toolkit-preload"}},[t._v("#")]),t._v(" 2.@electron-toolkit/preload")]),t._v(" "),s("p",[t._v("在预加载文件向渲染进程暴露方法")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" contextBridge "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" electronAPI "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@electron-toolkit/preload'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("contextIsolated"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("try")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    contextBridge"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("exposeInMainWorld")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'electron'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" electronAPI"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("catch")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  window"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("electron "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" electronAPI\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h4",{attrs:{id:"api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#api"}},[t._v("#")]),t._v(" API")]),t._v(" "),s("h5",{attrs:{id:"ipcrenderer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ipcrenderer"}},[t._v("#")]),t._v(" IpcRenderer")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("send")])]),t._v(" "),s("li",[s("code",[t._v("sendTo")])]),t._v(" "),s("li",[s("code",[t._v("sendSync")])]),t._v(" "),s("li",[s("code",[t._v("sendToHost")])]),t._v(" "),s("li",[s("code",[t._v("invoke")])]),t._v(" "),s("li",[s("code",[t._v("postMessage")])]),t._v(" "),s("li",[s("code",[t._v("on")])]),t._v(" "),s("li",[s("code",[t._v("once")])]),t._v(" "),s("li",[s("code",[t._v("removeAllListeners")])]),t._v(" "),s("li",[s("code",[t._v("removeListener")])])]),t._v(" "),s("h5",{attrs:{id:"webframe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webframe"}},[t._v("#")]),t._v(" WebFrame")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("insertCSS")])]),t._v(" "),s("li",[s("code",[t._v("setZoomFactor")])]),t._v(" "),s("li",[s("code",[t._v("setZoomLevel")])])]),t._v(" "),s("h5",{attrs:{id:"nodeprocess"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nodeprocess"}},[t._v("#")]),t._v(" NodeProcess")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("platform")]),t._v(" property")]),t._v(" "),s("li",[s("code",[t._v("versions")]),t._v(" property")]),t._v(" "),s("li",[s("code",[t._v("env")]),t._v(" property")])]),t._v(" "),s("h3",{attrs:{id:"_3-electron-toolkit-utils"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-electron-toolkit-utils"}},[t._v("#")]),t._v(" 3.@electron-toolkit/utils")]),t._v(" "),s("p",[t._v("主进程内使用的工具方法")]),t._v(" "),s("p",[t._v("####APIs")]),t._v(" "),s("h5",{attrs:{id:"is"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#is"}},[t._v("#")]),t._v(" is")]),t._v(" "),s("ul",[s("li",[t._v("dev\n"),s("ul",[s("li",[t._v("Type: boolean, "),s("code",[t._v("true")]),t._v(" when "),s("code",[t._v("app.isPackaged")]),t._v(" is "),s("code",[t._v("false")])])])])]),t._v(" "),s("h5",{attrs:{id:"platform"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#platform"}},[t._v("#")]),t._v(" platform")]),t._v(" "),s("ul",[s("li",[t._v("isWindows\n"),s("ul",[s("li",[t._v("Type: boolean, "),s("code",[t._v("true")]),t._v(" when "),s("code",[t._v("process.platform")]),t._v(" is "),s("code",[t._v("win32")])])])]),t._v(" "),s("li",[t._v("isMacOS\n"),s("ul",[s("li",[t._v("Type: boolean, "),s("code",[t._v("true")]),t._v(" when "),s("code",[t._v("process.platform")]),t._v(" is "),s("code",[t._v("darwin")])])])]),t._v(" "),s("li",[t._v("isLinux\n"),s("ul",[s("li",[t._v("Type: boolean, "),s("code",[t._v("true")]),t._v(" when "),s("code",[t._v("process.platform")]),t._v(" is "),s("code",[t._v("linux")])])])])]),t._v(" "),s("h5",{attrs:{id:"electronapp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#electronapp"}},[t._v("#")]),t._v(" electronApp")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("setAppUserModelId")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (id: string): void")])]),t._v(" "),s("li",[s("p",[t._v("Platform: win32")]),t._v(" "),s("p",[t._v("The "),s("code",[t._v("id")]),t._v(" is used only when the applcation is packaged. otherwise use the "),s("code",[t._v("process.execPath")]),t._v(" value as id. See https://www.electronjs.org/docs/latest/tutorial/notifications#windows")])])])]),t._v(" "),s("li",[s("p",[t._v("setAutoLaunch")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (auto: boolean) => boolean")])]),t._v(" "),s("li",[s("p",[t._v("Platform: darwin,win32")]),t._v(" "),s("p",[t._v("Set the app automatically open at login or not")])])])]),t._v(" "),s("li",[s("p",[t._v("skipProxy")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: () => Promise")])]),t._v(" "),s("li",[s("p",[t._v("Kind: async, sequential")]),t._v(" "),s("p",[t._v("Skip proxy for Electron app")])])])])]),t._v(" "),s("h5",{attrs:{id:"ipchelper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ipchelper"}},[t._v("#")]),t._v(" ipcHelper")]),t._v(" "),s("blockquote",[s("p",[t._v("The Ipc helper can make you easy to manage your main Ipc.")])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("handle")]),t._v(" "),s("ul",[s("li",[t._v("Type: (channel: string, listener: (event: IpcMainInvokeEvent, ...args: any[]) => Promise | any): void")]),t._v(" "),s("li",[t._v("Kind: async, sequential")])])]),t._v(" "),s("li",[s("p",[t._v("on")]),t._v(" "),s("ul",[s("li",[t._v("Type: () => (channel: string, listener: (event: IpcMainEvent, ...args: any[]) => void): this")])])]),t._v(" "),s("li",[s("p",[t._v("removeAllListeners")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (): this")]),t._v(" "),s("p",[t._v("Remove all register ipc listeners")])])])]),t._v(" "),s("li",[s("p",[t._v("removeAllHandlers")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (): void")]),t._v(" "),s("p",[t._v("Remove all register ipc handlers")])])])]),t._v(" "),s("li",[s("p",[t._v("removeListeners")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (channels: string[]): this")]),t._v(" "),s("p",[t._v("Remove ipc listeners")])])])]),t._v(" "),s("li",[s("p",[t._v("removeHandlers")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (channels: string[]): void")]),t._v(" "),s("p",[t._v("Remove ipc handlers")])])])])]),t._v(" "),s("h5",{attrs:{id:"optimizer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#optimizer"}},[t._v("#")]),t._v(" optimizer")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("watchWindowShortcuts")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: (window: BrowserWindow, shortcutOptions?: shortcutOptions) => void")]),t._v(" "),s("p",[t._v("Default open or close DevTools by "),s("code",[t._v("F12")]),t._v(" in development and ignore "),s("code",[t._v("CommandOrControl + R")]),t._v(" in production. Furthermore, you can use "),s("code",[t._v("shortcutOptions")]),t._v(" to control more shortcuts.")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("import { app } from 'electron'\nimport { optimizer } from '@electron-toolkit/utils'\n\napp.whenReady().then(() => {\n  app.on('browser-window-created', (_, window) => {\n    optimizer.watchWindowShortcuts(window)\n  })\n})\n")])])])])])]),t._v(" "),s("li",[s("p",[t._v("registerFramelessWindowIpc")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("Type: () => void")]),t._v(" "),s("p",[t._v("If use a frameless window which hide the system's native window controls, we may need to create custom window controls in HTML.")]),t._v(" "),s("p",[t._v("The frameless window ipc allow the renderer process to control the browser window.")]),t._v(" "),s("p",[t._v("The ipc channel named "),s("strong",[s("code",[t._v("win:invoke")])]),t._v(".")]),t._v(" "),s("p",[t._v("Example:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// main.js\nimport { app } from 'electron'\nimport { optimizer } from '@electron-toolkit/utils'\n\napp.whenReady().then(() => {\n  optimizer.registerFramelessWindowIpc()\n})\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// renderer.js or preload.js\nipcRenderer.send('win:invoke', 'show')\nipcRenderer.send('win:invoke', 'showInactive')\nipcRenderer.send('win:invoke', 'min')\nipcRenderer.send('win:invoke', 'max')\nipcRenderer.send('win:invoke', 'close')\n")])])])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);